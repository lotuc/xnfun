<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>lotuc.xnfun.core.node documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script><script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-76420995-1', 'auto');
  ga('send', 'pageview');
</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">xnfun</span> <span class="project-version"></span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Introduction to xnfun (Cross Node Function)</span></div></a></li><li class="depth-1 "><a href="thoughts.html"><div class="inner"><span>Thoughts about xnfun</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>lotuc</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>xnfun</span></div></div></li><li class="depth-3 branch"><a href="lotuc.xnfun.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></div></li><li class="depth-4 branch current"><a href="lotuc.xnfun.core.node.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>node</span></div></a></li><li class="depth-4 branch"><a href="lotuc.xnfun.core.transport.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>transport</span></div></a></li><li class="depth-4"><a href="lotuc.xnfun.core.transport-mqtt.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>transport-mqtt</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-add-function.21"><div class="inner"><span>add-function!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-call-function.21"><div class="inner"><span>call-function!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-clean-node.21"><div class="inner"><span>clean-node!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-fullfill-promise.21"><div class="inner"><span>fullfill-promise!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-get-promise"><div class="inner"><span>get-promise</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-make-node"><div class="inner"><span>make-node</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-node-functions"><div class="inner"><span>node-functions</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-node-futures"><div class="inner"><span>node-futures</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-node-hb-listener"><div class="inner"><span>node-hb-listener</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-node-hb-timer"><div class="inner"><span>node-hb-timer</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-node-info"><div class="inner"><span>node-info</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-node-promises"><div class="inner"><span>node-promises</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-node-remote-nodes"><div class="inner"><span>node-remote-nodes</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-node-rpc-listener"><div class="inner"><span>node-rpc-listener</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-node-transport"><div class="inner"><span>node-transport</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-on-heartbeat.21"><div class="inner"><span>on-heartbeat!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-remove-dead-workers.21"><div class="inner"><span>remove-dead-workers!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-select-remote-node"><div class="inner"><span>select-remote-node</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-serve-remote-call.21"><div class="inner"><span>serve-remote-call!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-start-heartbeat.21"><div class="inner"><span>start-heartbeat!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-start-heartbeat-listener.21"><div class="inner"><span>start-heartbeat-listener!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-start-node-transport.21"><div class="inner"><span>start-node-transport!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-stop-heartbeat.21"><div class="inner"><span>stop-heartbeat!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-stop-heartbeat*"><div class="inner"><span>stop-heartbeat*</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-stop-heartbeat-listener.21"><div class="inner"><span>stop-heartbeat-listener!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-stop-heartbeat-listener*"><div class="inner"><span>stop-heartbeat-listener*</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-stop-node-transport.21"><div class="inner"><span>stop-node-transport!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-stop-serve-remote-call.21"><div class="inner"><span>stop-serve-remote-call!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-submit-call.21"><div class="inner"><span>submit-call!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-submit-promise.21"><div class="inner"><span>submit-promise!</span></div></a></li><li class="depth-1"><a href="lotuc.xnfun.core.node.html#var-submit-remote-call.21"><div class="inner"><span>submit-remote-call!</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">lotuc.xnfun.core.node</h1><div class="doc"><div class="markdown"><p>Node abstraction for xnfun.</p>
<ul>
<li>You can start a transport (ex. MQTT transport) for connecting with other nodes.</li>
<li>You can register (capability) functions to current node.</li>
<li>You can submit function call to current node (call you registered functions).</li>
<li>You can register a promise to current node and maybe fullfill it later.</li>
<li>You can do call to other node through current node via your established transport</li>
</ul>
<p>When caller call from one node to other node’s function (callee), this will</p>
<ul>
<li>Submit a promise in current node waiting for result.</li>
<li>Submit a future (representing the remote computation, the callee) in remote node.</li>
<li>Create a bi-directional communication channel between caller and callee.</li>
</ul>
<p><strong>Node</strong></p>
<ul>
<li><a href="lotuc.xnfun.core.node.html#var-make-node">make-node</a></li>
<li><a href="lotuc.xnfun.core.node.html#var-node-info">node-info</a></li>
<li><a href="lotuc.xnfun.core.node.html#var-node-transport">node-transport</a> <a href="lotuc.xnfun.core.node.html#var-node-futures">node-futures</a> <a href="lotuc.xnfun.core.node.html#var-node-promises">node-promises</a> <a href="lotuc.xnfun.core.node.html#var-node-remote-nodes">node-remote-nodes</a></li>
<li><a href="lotuc.xnfun.core.node.html#var-select-remote-node">select-remote-node</a></li>
<li>
<p><a href="lotuc.xnfun.core.node.html#var-start-node-transport.21">start-node-transport!</a> <a href="lotuc.xnfun.core.node.html#var-stop-node-transport.21">stop-node-transport!</a></p>
</li>
<li><a href="lotuc.xnfun.core.node.html#var-on-heartbeat.21">on-heartbeat!</a>  <a href="lotuc.xnfun.core.node.html#var-remove-dead-workers.21">remove-dead-workers!</a></li>
<li><a href="lotuc.xnfun.core.node.html#var-start-heartbeat.21">start-heartbeat!</a> <a href="lotuc.xnfun.core.node.html#var-stop-heartbeat.21">stop-heartbeat!</a></li>
<li><a href="lotuc.xnfun.core.node.html#var-start-heartbeat-listener.21">start-heartbeat-listener!</a> <a href="lotuc.xnfun.core.node.html#var-stop-heartbeat-listener.21">stop-heartbeat-listener!</a></li>
</ul>
<p><strong>Capabilities</strong></p>
<ul>
<li><a href="lotuc.xnfun.core.node.html#var-add-function.21">add-function!</a> <a href="lotuc.xnfun.core.node.html#var-call-function.21">call-function!</a></li>
</ul>
<p><strong>Promises</strong></p>
<ul>
<li><a href="lotuc.xnfun.core.node.html#var-fullfill-promise.21">fullfill-promise!</a> <a href="lotuc.xnfun.core.node.html#var-submit-promise.21">submit-promise!</a></li>
</ul>
<p><strong>Function call</strong></p>
<ul>
<li><a href="lotuc.xnfun.core.node.html#var-submit-call.21">submit-call!</a></li>
</ul>
<p><strong>Remote function call</strong></p>
<ul>
<li><a href="lotuc.xnfun.core.node.html#var-submit-remote-call.21">submit-remote-call!</a></li>
<li><a href="lotuc.xnfun.core.node.html#var-serve-remote-call.21">serve-remote-call!</a> <a href="lotuc.xnfun.core.node.html#var-stop-serve-remote-call.21">stop-serve-remote-call!</a></li>
</ul>
</div></div><div class="public anchor" id="var-add-function.21"><h3>add-function!</h3><div class="usage"><code>(add-function! {:as node} fun-name fun &amp; {:as opts, :keys [overwrite]})</code></div><div class="doc"><div class="markdown"><p>Register a supported function to current node.</p>
<p>With <code>overwrite</code> being false, throw if the same name already exists.</p>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L420">view source</a></div></div><div class="public anchor" id="var-call-function.21"><h3>call-function!</h3><div class="usage"><code>(call-function! node fun-name params &amp; {:as options, :keys [out-c in-c req-meta]})</code></div><div class="doc"><div class="markdown"><p>Call registered function with name.</p>
<p>All data should be format of <code>{:keys [typ data]}</code></p>
<p>Arguments:</p>
<ul>
<li><code>out-c</code> (optional): function can send message to caller via the channel
<ul>
<li><code>:typ=:xnfun/hb</code>: Long-running function heartbeat</li>
<li><code>:typ=:xnfun/to-caller</code>: Message to caller</li>
</ul>
</li>
<li><code>in-c</code> (optional): caller send some signal to callee
<ul>
<li><code>:typ=:xnfun/cancel</code>: Cancellation message.</li>
<li><code>:typ=:xnfun/to-callee</code>: Message to callee.</li>
</ul>
</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L430">view source</a></div></div><div class="public anchor" id="var-clean-node.21"><h3>clean-node!</h3><div class="usage"><code>(clean-node! node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L172">view source</a></div></div><div class="public anchor" id="var-fullfill-promise.21"><h3>fullfill-promise!</h3><div class="usage"><code>(fullfill-promise! {:as node, :keys [node-id]} req-id {:as r, :keys [status data]})</code></div><div class="doc"><div class="markdown"><p>Handling data from callee.</p>
<p>Arguments:</p>
<ul>
<li><code>:status</code>: <code>:ok</code> or <code>:xnfun/err</code> or <code>:xnfun/remote-err</code> or <code>:err</code>
<ul>
<li>When error is assured triggered by the user’s function code, no matter it runs locally or remotely, the status should be <code>:err</code></li>
<li>When error is not assured triggered by user’s function code:
<ul>
<li><code>:xnfun/err</code>: Error occurs locally</li>
<li><code>:xnfun/remote-err</code>: Error occurs remotely</li>
</ul>
</li>
</ul>
</li>
<li><code>:meta</code>: the call metadata.</li>
<li><code>:data</code>: If <code>status=:ok</code>, means the fullfilled data; else the data describing the error.</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L460">view source</a></div></div><div class="public anchor" id="var-get-promise"><h3>get-promise</h3><div class="usage"><code>(get-promise node req-id)</code></div><div class="doc"><div class="markdown"><p>Get the submitted promsie by <a href="lotuc.xnfun.core.node.html#var-submit-promise.21">submit-promise!</a>.</p>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L485">view source</a></div></div><div class="public anchor" id="var-make-node"><h3>make-node</h3><div class="usage"><code>(make-node &amp; {:keys [node-id node-options]})</code></div><div class="doc"><div class="markdown"><p>Create a node.</p>
<p>A node contains:</p>
<ul>
<li><code>:node-id</code>: The global identifier for given connection transport.</li>
<li><code>:node-options</code>: The options specified for given node. Check <a href="null">make-node-options</a> for details.</li>
<li><code>:node-state</code>: The mutable state for this node. Check <a href="null">make-node-state</a> for details.</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L156">view source</a></div></div><div class="public anchor" id="var-node-functions"><h3>node-functions</h3><div class="usage"><code>(node-functions node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L182">view source</a></div></div><div class="public anchor" id="var-node-futures"><h3>node-futures</h3><div class="usage"><code>(node-futures node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L179">view source</a></div></div><div class="public anchor" id="var-node-hb-listener"><h3>node-hb-listener</h3><div class="usage"><code>(node-hb-listener node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L186">view source</a></div></div><div class="public anchor" id="var-node-hb-timer"><h3>node-hb-timer</h3><div class="usage"><code>(node-hb-timer node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L181">view source</a></div></div><div class="public anchor" id="var-node-info"><h3>node-info</h3><div class="usage"><code>(node-info {:as node, :keys [node-id node-state node-options]})</code></div><div class="doc"><div class="markdown"><p>Retrieve node’s supported functions as: <code>function-name -&gt; {:keys [arity]}</code></p>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L189">view source</a></div></div><div class="public anchor" id="var-node-promises"><h3>node-promises</h3><div class="usage"><code>(node-promises node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L187">view source</a></div></div><div class="public anchor" id="var-node-remote-nodes"><h3>node-remote-nodes</h3><div class="usage"><code>(node-remote-nodes node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L185">view source</a></div></div><div class="public anchor" id="var-node-rpc-listener"><h3>node-rpc-listener</h3><div class="usage"><code>(node-rpc-listener node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L183">view source</a></div></div><div class="public anchor" id="var-node-transport"><h3>node-transport</h3><div class="usage"><code>(node-transport node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L180">view source</a></div></div><div class="public anchor" id="var-on-heartbeat.21"><h3>on-heartbeat!</h3><div class="usage"><code>(on-heartbeat! node msg)</code><code>(on-heartbeat! node hb-msg now-ms)</code></div><div class="doc"><div class="markdown"><p>Handle heartbeat message from <code>node-id</code>.</p>
<p>Heartbeat message derived from <a href="lotuc.xnfun.core.node.html#var-node-info">node-info</a>, the structure is the same.</p>
<p>The node’s hb message may contains the functions it now supports.</p>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L215">view source</a></div></div><div class="public anchor" id="var-remove-dead-workers.21"><h3>remove-dead-workers!</h3><div class="usage"><code>(remove-dead-workers! node)</code><code>(remove-dead-workers! {:as node, :keys [node-options]} now-ms)</code></div><div class="doc"><div class="markdown"><p>Try remove all node that losts their heartbeat.</p>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L288">view source</a></div></div><div class="public anchor" id="var-select-remote-node"><h3>select-remote-node</h3><div class="usage"><code>(select-remote-node {:as node} {:keys [match-fn]})</code></div><div class="doc"><div class="markdown"><p>Filter out node that satisties the condition and randomly selects one. - <code>match-fn</code>: matches if (match-fn node)</p>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L394">view source</a></div></div><div class="public anchor" id="var-serve-remote-call.21"><h3>serve-remote-call!</h3><div class="usage"><code>(serve-remote-call! {:as node, :keys [node-id]})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L946">view source</a></div></div><div class="public anchor" id="var-start-heartbeat.21"><h3>start-heartbeat!</h3><div class="usage"><code>(start-heartbeat! {:as node, :keys [node-id]})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L312">view source</a></div></div><div class="public anchor" id="var-start-heartbeat-listener.21"><h3>start-heartbeat-listener!</h3><div class="usage"><code>(start-heartbeat-listener! {:as node, :keys [node-id]})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L358">view source</a></div></div><div class="public anchor" id="var-start-node-transport.21"><h3>start-node-transport!</h3><div class="usage"><code>(start-node-transport! {:as node, :keys [node-id], {:keys [transport]} :node-state})</code></div><div class="doc"><div class="markdown"><p>Start node transport.</p>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L240">view source</a></div></div><div class="public anchor" id="var-stop-heartbeat.21"><h3>stop-heartbeat!</h3><div class="usage"><code>(stop-heartbeat! {:as node, :keys [node-id]})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L304">view source</a></div></div><div class="public anchor" id="var-stop-heartbeat*"><h3>stop-heartbeat*</h3><div class="usage"><code>(stop-heartbeat* node-id hb-timer)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L297">view source</a></div></div><div class="public anchor" id="var-stop-heartbeat-listener.21"><h3>stop-heartbeat-listener!</h3><div class="usage"><code>(stop-heartbeat-listener! {:as node, :keys [node-id]})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L350">view source</a></div></div><div class="public anchor" id="var-stop-heartbeat-listener*"><h3>stop-heartbeat-listener*</h3><div class="usage"><code>(stop-heartbeat-listener* node-id hb-listener)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L343">view source</a></div></div><div class="public anchor" id="var-stop-node-transport.21"><h3>stop-node-transport!</h3><div class="usage"><code>(stop-node-transport! {:as node, :keys [node-id]})</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L233">view source</a></div></div><div class="public anchor" id="var-stop-serve-remote-call.21"><h3>stop-serve-remote-call!</h3><div class="usage"><code>(stop-serve-remote-call! node)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L937">view source</a></div></div><div class="public anchor" id="var-submit-call.21"><h3>submit-call!</h3><div class="usage"><code>(submit-call! {:as node, :keys [node-id]} fun-name params &amp; {:as options, :keys [req-meta out-c]})</code></div><div class="doc"><div class="markdown"><p>Submit function to node and run it asynchronously.</p>
<p>Arguments</p>
<ul>
<li><code>out-c</code>: callee will send message (and heartbeat) throught this channel.
<ul>
<li>If not given, will create a dropping buffer channel</li>
<li>Notice that the out-c would block callee, so you should handle the message as soon as possible.</li>
</ul>
</li>
<li><code>req-meta</code>: Check <a href="null">make-req-meta</a> for details.</li>
</ul>
<p>Returns <code>{:keys [req-id submit-at request running-future in-c out-c timeout-timer hb-lost-timer]}</code></p>
<p><code>in-c</code> accepts:</p>
<ul>
<li>{<code>:typ</code> <code>:xnfun/cancel</code> <code>:data</code> …}</li>
<li>{<code>:typ</code> <code>:xnfun/to-callee</code> <code>:data</code> …}</li>
</ul>
<p><code>out-c</code> returns:</p>
<ul>
<li>{<code>:typ</code> <code>:xnfun/hb</code> <code>:data</code> …}</li>
<li>{<code>:typ</code> <code>:xnfun/to-caller</code> <code>:data</code> …}</li>
</ul>
<p>Check <a href="lotuc.xnfun.core.node.html#var-call-function.21">call-function!</a> for <code>in-c</code> and <code>out-c</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L694">view source</a></div></div><div class="public anchor" id="var-submit-promise.21"><h3>submit-promise!</h3><div class="usage"><code>(submit-promise! {:as node, :keys [node-id]} {:as request, :keys [req-meta]})</code></div><div class="doc"><div class="markdown"><p>Submit promise to node.</p>
<p>The submitted promise may be fullfilled on timeout. Or can be fullfilled manually with: <a href="lotuc.xnfun.core.node.html#var-fullfill-promise.21">fullfill-promise!</a></p>
<p>Returns: <code>{:keys [res-promise request timeout-timer hb-lost-timer]}</code></p>
<ul>
<li><code>request</code>: {:keys <a href="`req-meta`"><code>req-meta</code></a>}</li>
</ul>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L527">view source</a></div></div><div class="public anchor" id="var-submit-remote-call.21"><h3>submit-remote-call!</h3><div class="usage"><code>(submit-remote-call! node fun-name params &amp; {:as options, :keys [req-meta out-c match-node-fn]})</code></div><div class="doc"><div class="markdown"><p>Submit call to remote nodes.</p>
<p>Node is selected by the optional <code>match-node-fn</code> and the <code>fun-name</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/lotuc/xnfun/blob/master/src/main/clj/lotuc/xnfun/core/node.clj#L916">view source</a></div></div></div></body></html>